<!DOCTYPE HTML><html><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><title>实时天气</title><link href="static/css/bootstrap.css" rel="stylesheet" /><link href="static/css/style.css" rel="stylesheet" /><link rel="shortcut icon" href="static/images/favicon.png" /><link rel="apple-touch-icon" sizes="57x57" href="static/images/apple-touch-icon.png" /><link rel="apple-touch-icon" sizes="72x72" href="static/images/apple-touch-icon-72x72.png" /><link rel="apple-touch-icon" sizes="114x114" href="static/images/apple-touch-icon-114x114.png" /></head><body><header><a href="/">天气播报</a></header>	<input type="text" placeholder="请输入城市名称，如‘北京’" id="incity" x-webkit-speech onwebkitspeechchange="$('#subCity').click()" lang="zh-CN" size="30" /> <input type="submit" value="提交" id="subCity" />	<div>		<select name="province" id="province">			<option value="109">B 北京</option> <option value="117">S 上海</option> <option value="110">T 天津</option> <option value="135">C 重庆</option> <option value="119">A 安徽</option> <option value="123">F 福建</option> <option value="127">G 广东</option> <option value="128">G 广西</option> <option value="137">G 贵州</option> <option value="131">G 甘肃</option> <option value="111">H 河北</option> <option value="124">H 河南</option> <option value="125">H 湖北</option> <option value="126">H 湖南</option> <option value="129">H 海南</option> <option value="116">H 黑龙江</option> <option value="122">J 江西</option> <option value="120">J 江苏</option> <option value="115">J 吉林</option> <option value="114">L 辽宁</option> <option value="132">N 宁夏</option> <option value="113">N 内蒙古</option> <option value="133">Q 青海</option> <option value="118">S 山东</option> <option value="112">S 山西</option> <option value="130">S 陕西</option> <option value="136">S 四川</option> <option value="139">X 西藏</option> <option value="134">X 新疆</option> <option value="138">Y 云南</option> <option value="121">Z 浙江</option> <option value="140">X 香港</option> <option value="141">A 澳门</option> <option value="142">T 台湾</option>		</select>		<select name="city" id="city"></select>		<select name="town" id="town"></select>		<button id="btn">天气预报</button>		<button id="btn2">实时天气</button>		<button id="autoPlace">自动判断</button>	</div>	<pre></pre><script type="text/javascript" src="static/js/jquery.min.js" ></script><script type="text/javascript" src="static/js/cityArr.js" ></script><script type="text/javascript">var weather = {    initCitys: function (pid) {        if (!pid) return;        $("#city").html("");        var option = '';        for (var i = 0, len = CityArr.length; i < len; i++) {            if (CityArr[i][1] == pid){                option += '<option value="'+CityArr[i][2]+'">'+ CityArr[i][3] + '&nbsp;' + CityArr[i][0] +'</option>';            }        }        $("#city").html(option);		var cityCode = $("#city").val().slice(3, 7);		$.getScript('http://weather.api.114la.com/' + cityCode + '/' +cityCode + '.txt?' + parseInt(Math.random() * 99));    },    getWeather:function(cityid,t){    	var sta = (typeof(t) == 'undefined') ? '' : '&type=' + t ;    	$.getJSON('api/weather.php?id=' + cityid + sta + '&callback=?',function (Data){    	    if (typeof (Data) == "object" && typeof (Data) != "undefined" && typeof (Data.weatherinfo) != "undefined" && Data.weatherinfo != false) {		    	var data = Data['weatherinfo'];		    	var info = [];				$.each(data, function (key,val) {					info.push(key + ":" + val );				})		    	$("pre").html(info.join(",\n"));		    }else{		        alert('数据加载错误，请稍后再试~')		    }    	})    }}if (typeof Ylmf === 'undefined') {    var Ylmf = {};}//根据ip显示省级并加载天气$.getScript('http://api.114la.com/ip');function ILData_callback(){	if (typeof (ILData) != "undefined" && ILData[2] && ILData[3]) {    	$("#province").find('option').each(function(){    		if($(this).text().slice(2) == ILData[2]){    			$(this).attr("selected","selected");    		}    	})    	var provCode = $("#province").val();    	weather.initCitys(provCode);    	$("#city").find('option').each(function(){    		if($(this).text().slice(2) == ILData[3]){    			$(this).attr("selected","selected");    		}    	})		var cityCode = $("#city").val().slice(3, 7);		$.getScript('http://weather.api.114la.com/' + cityCode + '/' +cityCode + '.txt?' + parseInt(Math.random() * 99));		weather.getWeather($("#city").val())    }else{    	alert('数据加载错误，请稍后再试~')    }}//取得城市数据window.Ylmf.getAreaCity = function (O) {    if (typeof (O) == "object" && typeof (O.result) != "undefined" && typeof (O.result[0][0]) != "undefined") {    	$("#town").html("");    	var data = O['result'], option = '';    	for(var i = 0;i < data.length;i++){    		option += '<option value="'+data[i][0]+'">'+data[i][2]+'&nbsp;'+data[i][1]+'</option>'    	}    	$("#town").html(option);  //   	var cityCode = $("#town").val();		// weather.getWeather(cityCode)    }else{    	alert('数据加载错误，请稍后再试~')    }}//加载城市联动数据$("#province").bind( "change" , function(){	var provCode = $("#province").val();	weather.initCitys(provCode);})//加载县区联动数据$("#city").bind( "change" , function(){	var cityCode = $(this).val().slice(3, 7);	$.getScript('http://weather.api.114la.com/' + cityCode + '/' +cityCode + '.txt?' + parseInt(Math.random() * 99));})//选择城镇请求城市数据$("#town").bind( "change" , function(){	var cityCode = $("#town").val();	weather.getWeather(cityCode)})//全部天气概况$("#btn").bind( "click" , function() {	var cityCode = $("#town").val();	weather.getWeather(cityCode)})//即时天气$("#btn2").bind( "click" , function() {	var cityCode = $("#town").val();	weather.getWeather(cityCode,"sk")})//自动判断，包括ip和加载天气$("#autoPlace").bind( "click" , function() {	ILData_callback();})//输入框请求数据$("#subCity").bind("click", function(){	var incity = $("#incity").val(), cityCode;	//console.log(CityArr[10][0])	for (var i = 1, len = CityArr.length; i < len; i++) {		if(incity == ''){			alert("请输入城市名称，如‘北京’")			return false;		}else if (CityArr[i][0] == incity && CityArr[i][2].slice(3) != ''){        	cityCode = CityArr[i][2].slice(3, 7)            $.getScript('http://weather.api.114la.com/' + cityCode + '/' + CityArr[i][2] + '.txt?' + parseInt(Math.random() * 99));            return false;        }    }    $("#incity").val("");})</script><!--[if IE]><script src="static/js/ie.js"></script><![endif]--></body></html>